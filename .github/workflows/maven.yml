name: CI  on macos linux windows

on: [push]

jobs:
  linux and maxOS:
    name: Test on ${{ matrix.os }}
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest,macOS-latest]
    
    steps:
    - uses: actions/checkout@master
    - uses: actions/cache@v1
      id: cache
      with:
        path: ~/.m2/repository
        key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}
        restore-keys: |
          ${{ runner.os }}-maven-
             
    - name: Install depend with ${{ matrix.os }}
      if: steps.cache.outputs.cache-hit != 'true'
      run: |
        JAVA_HOME=$JAVA_HOME_11_X64
        mvn -f gson install -DskipTests=true
          
    - name: Build with ${{ matrix.os }}
      run: |
           JAVA_HOME=$JAVA_HOME_11_X64      
           mvn -f gson test   
           		                     
  windows:
   runs-on: windows-latest
   
   steps:
     - uses: actions/checkout@master
     - uses: actions/cache@v1
       id: cache
       with:
         path: ~/.m2/repository
         key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}
         restore-keys: |
           ${{ runner.os }}-maven-
           
     - name: Install depend with windows
       if: steps.cache.outputs.cache-hit != 'true'
       env:
         JAVA_HOME: C:\Program Files\Java\zulu-11-azure-jdk_11.33.15-11.0.4-win_x64 
       run: |
         $env:PATH="$env:JAVA_HOME/bin;$env:PATH"
         mvn -f gson install -DskipTests=true
        
     - name: Build with windows
       env:
         JAVA_HOME: C:\Program Files\Java\zulu-11-azure-jdk_11.33.15-11.0.4-win_x64 
       run: |
           $env:PATH="$env:JAVA_HOME/bin;$env:PATH"
           mvn -f gson test   
